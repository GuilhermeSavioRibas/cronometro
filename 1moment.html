<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Timer com Comandos de Voz</title>
    <style>
        body {
            font-family: Arial, sans-serif;
        }
        .timer {
            font-size: 48px;
            text-align: center;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <h1>Timer de Atendimento</h1>
    <div class="timer" id="timer">00:00</div>
    <script>
        let minutes = 0;
        let seconds = 0;
        let timerInterval = null;
        let isTimerRunning = false;

        // Função para tocar o beep quando o cronômetro chega a 01:50
        function playBeep() {
            var beep = new Audio('beep.mp3');  // Certifique-se de que o arquivo 'beep.mp3' está no mesmo diretório
            beep.play().catch(error => console.log('Erro ao tocar o beep:', error));
        }

        // Função para atualizar o cronômetro na tela
        function updateTimerDisplay() {
            const display = document.getElementById('timer');
            const formattedMinutes = minutes.toString().padStart(2, '0');
            const formattedSeconds = seconds.toString().padStart(2, '0');
            display.textContent = `${formattedMinutes}:${formattedSeconds}`;
        }

        // Função principal do cronômetro
        function startTimer() {
            if (!isTimerRunning) {
                isTimerRunning = true;
                timerInterval = setInterval(() => {
                    seconds++;
                    if (seconds === 60) {
                        seconds = 0;
                        minutes++;
                    }
                    updateTimerDisplay();
                    checkTime();
                }, 1000);
            }
        }

        // Função para verificar se chegou a 01:50 e tocar o beep
        function checkTime() {
            if (minutes === 1 && seconds === 50) {
                playBeep();  // Toca o beep ao atingir 01:50
            }
        }

        // Função para parar o cronômetro
        function stopTimer() {
            clearInterval(timerInterval);
            isTimerRunning = false;
            minutes = 0;
            seconds = 0;
            updateTimerDisplay();
        }

        // Inicializa a API de reconhecimento de voz
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        const recognition = new SpeechRecognition();
        recognition.lang = 'pt-BR';  // Define o idioma para português
        recognition.continuous = true;  // Mantém o reconhecimento contínuo
        recognition.interimResults = false;  // Apenas resultados finais

        // Função de reconhecimento de voz
        recognition.onresult = function (event) {
            const transcript = event.results[event.resultIndex][0].transcript.toLowerCase();
            console.log('Comando recebido:', transcript);

            // Verifica se o comando de voz contém as frases relacionadas
            if (transcript.includes('um momento') || transcript.includes('mais um momento') || transcript.includes('só um momento')) {
                startTimer();  // Inicia o cronômetro
            } else if (transcript.includes('obrigado por aguardar') || transcript.includes('valeu por esperar')) {
                stopTimer();  // Para o cronômetro
            }
        };

        // Função de erro no reconhecimento de voz
        recognition.onerror = function (event) {
            console.error('Erro no reconhecimento de voz:', event.error);
            if (event.error === 'not-allowed') {
                alert('Permissão para usar o microfone foi negada.');
            }
        };

        // Inicia o reconhecimento de voz automaticamente
        function startRecognition() {
            recognition.start();
        }

        startRecognition();  // Chama a função para iniciar o reconhecimento

    </script>
</body>
</html>
